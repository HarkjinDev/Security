#!/bin/bash

. function.sh

BAR
CODE [U-45] root 계정 su 제한
cat << EOF >> $RESULT
[양호]: su 명령어를 특정 그룹에 속한 사용자만 사용하도록 제한되어 있는 경우
[취약]: su 명령어를 모든 사용자가 사용하도록 설정되어 있는 경우
EOF
BAR

PAM_FILE=/etc/pam.d/su
PAM_MODULE=pam_wheel.so
GROUPFILE=/etc/group

egrep -v '^#|^$' $PAM_FILE | grep -q $PAM_MODULE
if [ $? -eq 0 ] ; then
	OK $PAM_MODULE 설정이 되어 있습니다.
	if grep -q wheel $GROUPFILE; then
		OK wheel 그룹이 존재합니다.
	else
		WARN wheel 그룹이 존재하지 않습니다.
	fi
else
	WARN $PAM_MODULE 설정이 되어 있지 않습니다.
fi

cat $RESULT
echo
