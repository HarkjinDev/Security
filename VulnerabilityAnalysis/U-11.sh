#!/bin/bash

. function.sh

TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE "[U-11] /etc/syslog.conf 파일 소유자 및 권한 설정"
cat << EOF >> $RESULT
[양호]:   /etc/syslog.conf 파일의 소유자가 root(또는 bin, sys)이고, 권한이 640 이하인 경우
[취약]:  /etc/syslog.conf 파일의 소유자가 root(또는 bin, sys)가 아니거나, 권한이 640 이하가 아닌 경우
EOF
BAR

# CentOS7 : /etc/rsyslog.conf
FILENAME=/etc/rsyslog.conf
OWNER=$(ls -l $FILENAME | awk {'print $3'})
PERM=$(ls -l $FILENAME | awk -F . {'print $1'})

if [ $OWNER = "root" ] || [ $OWNER = "bin" ] || [ $OWNER = "sys" ]; then
	OK $FILENAME 파일의 소유자가 root/bin/sys 입니다.
else
	WARN $FILENAME 파일의 소유자가 root/bin/sys 가 아닙니다.
fi

if [ $PERM = "-rw-r-----" ] ; then
	OK $FILENAME 파일의 권한이 640이하 입니다.
else
	WARN $FILENAME 파일의 권한이 640이하가 아닙니다.
fi

cat $RESULT
