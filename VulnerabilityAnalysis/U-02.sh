#!/bin/bash

. function.sh

TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [U-02] 패스워드 복잡성 검사
cat << EOF >> $RESULT
[양호]: 영문 숫자 특수문자가 혼합된 8 글자 이상의 패스워드가 설정된 경우.
[취약]: 영문 숫자 특수문자 혼합되지 않은 8 글자 미만의 패스워드가 설정된 경우.
EOF
BAR

echo >> $TMP1
echo "다음은 /etc/security/pwquality.conf 내용입니다." >> $TMP1
echo "=============================================================" >> $TMP1
cat /etc/security/pwquality.conf | egrep -v '(^$|^#)' >> $TMP1
cat << EOF >> $TMP1

=============================================================
다음은 /etc/security/pwquality.conf 파일을 해석할 때 사용하는 내용입니다.

minlen     : 패스워드 최소 길이입니다.
minclass   : 패스워드 class 지정입니다.
lcredit    : 패스워드 소문자 포함 지정입니다.
ucredit    : 패스워드 대문자 포함 지정입니다.
dcredit    : 패스워드 숫자 포함 지정입니다.
ocredit    : 패스워드 특수문자 포함 지정입니다.
=============================================================
다음은 /etc/security/pwquality.conf 파일의 내용이 없으면,

1)  기본값을 사용하는 경우입니다.  이 경우, 패스워드 정책에 맞지 않습니다. 
      따라서, 반드시 정책을 변경할 것을 권장합니다.
2)  정책을 변경하는 경우에는 다음과 같은 명령어를 통해 설정할 수 있습니다.
    # authconfig --passminlen=8 --passminclass=3 
    --enablereqlower --disablerequpper --enablereqdigit 
    --enablereqother --update
=============================================================
EOF

cat $RESULT
cat $TMP1
