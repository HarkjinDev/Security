#!/bin/bash

. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1
TMP2=$(mktemp)

BAR
CODE "[U-06] 파일 및 디렉토리 소유자 설정"
cat << EOF >> $RESULT
[양호: 소유자가 존재하지 않은 파일 및 디렉터리가 존재하지 않는 경우
취약: 소유자가 존재하지 않은 파일 및 디렉터리가 존재하는 경우
EOF
BAR

echo "[U-06] Checking.... Please wait a few minute...."
find / \( -nouser -o -nogroup \) -ls 2>/dev/null > $TMP2
if [ ! -s $TMP2 ] ; then
	OK 파일 및 디렉토리의 소유권이 정상적으로 설정되지 않은 파일이 존재하지 않는다.
else
	WARN 파일 및 디렉토리의 소유권이 정상적으로 설정되지 않은 파일이 존재한다.
	INFO $TMP1 파일을 참고 하십시오.
	cat <<- EOF >> $TMP1
	1. 파일 및 디렉토리 소유권/그룹권이 정상적으로 설정되지 않은 파일 목록

	$(cat $TMP2)
	EOF
fi

cat $RESULT
