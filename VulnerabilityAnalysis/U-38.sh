#!/bin/bash

. function.sh

TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE "[U-38] 웹서비스 불필요한 파일 제거"
cat << EOF >> $RESULT
[양호]:  기본으로 생성되는 불필요한 파일 및 디렉터리가 제거되어 있는 경우
[취약]:  기본으로 생성되는 불필요한 파일 및 디렉터리가 제거되지 않은 경우
EOF
BAR

TMP2=/tmp/tmp2
# File List
cat << EOF > $TMP2
/etc/httpd/htdocs/manual
/etc/httpd/manual
EOF

cat $TMP2 | while read FILENAME
do
	if [ -f $FILENAME ] ; then
		ls -l $FILENAME > $TMP1
		if [ -s $TMP1 ] ; then
			WARN $FILENAME 불필요한 파일이 존재합니다.
		fi
	else
		OK $FILENAME 불필요한 파일이 존재하지 않습니다.
		continue
	fi
done

cat $RESULT
