#!/bin/bash

. function.sh

TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE "[U-28] tftp, talk 서비스 비활성화"
cat << EOF >> $RESULT
[양호]:  tftp, talk, ntalk 서비스가 비활성화 되어 있는 경우
[취약]:  tftp, talk, ntalk 서비스가 활성화 되어 있는 경우
EOF
BAR

TMP2=/tmp/tmp2
# NIS NIS+ Service List
cat << EOF > $TMP2
tftp
talk
ntalk
EOF

cat $TMP2 | while read SERVICENAME
do
	ps -ef | grep $SERVICENAME | egrep -v "/bin/grep" > $TMP1
	if [ -s $TMP1 ] ; then
		WARN "$SERVICENAME 서비스(PID : $(cat $TMP1 | awk {'print $2'}))가 활성화 되어 있습니다."
	else
		OK $SERVICENAME 서비스가 활성화되어있지 않습니다.
	fi
done

cat $RESULT
