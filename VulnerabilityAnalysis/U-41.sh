#!/bin/bash

. function.sh

TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE "[U-41] 웹서비스 영역의 분리"
cat << EOF >> $RESULT
[양호]:  DocumentRoot를 별도의 디렉터리로 지정한 경우
[취약]:  DocumentRoot를 기본 디렉터리로 지정한 경우
EOF
BAR

SERVICE=$(systemctl is-active httpd.service)

if [ $SERVICE = "active" ] ; then
	INFO Apache 서비스가 활성화 되어있습니다.
	CHECK=$(cat /etc/httpd/conf/httpd.conf | grep "DocumentRoot" | grep -v "#" | tr -d "\"" | awk {'print $2'})
	if [ $CHECK == "/usr/local/apache/htdocs" ] || [ $CHECK == "/usr/local/apahce2/htdocs" ] || [ $CHECK == "/var/www/html" ] ; then
		WARN DocumentRoot를 기본 디렉터리로 지정되어 있습니다.
		INFO "DocumentRoot : $CHECK"
	else
		OK DocumentRoot를 기본 디렉터리로 지정되어 있지 않습니다.
		cat $TMP1
	fi
else
	OK Apache 서비스가 비활성화 되어있습니다.
fi

cat $RESULT
