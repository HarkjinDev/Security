#!/bin/bash

. function.sh

TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE "[U-28] NIS, NIS+ 점검"
cat << EOF >> $RESULT
[양호]:  NIS 서비스가 비활성화 되어 있거나, 필요 시 NIS+를 사용하는 경우
[취약]:  NIS 서비스가 활성화 되어 있는 경우
EOF
BAR

TMP2=/tmp/tmp2
# NIS NIS+ Service List
cat << EOF > $TMP2
ypserv
ypbind
rpc-yppasswdd
ypxfrd
rpc.ypupdated
EOF

cat $TMP2 | while read SERVICENAME
do
	CHECK=$(systemctl is-active $SERVICENAME)
	if [ $CHECK = "active" ] ; then
		WARN $SERVICENAME 서비스가 활성화 되어있습니다.
	else
		OK $SERVICENAME 서비스가 활성화되어있지 않습니다.
	fi
done

cat $RESULT
