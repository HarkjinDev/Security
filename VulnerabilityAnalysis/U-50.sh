#!/bin/bash

. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [U-50] 관리자 그룹에 최소한의 계정 포함
cat << EOF >> $RESULT
[양호]: 관리자 그룹에 불필요한 계정이 등록되어 있지 않은 경우
[취약]: 관리자 그룹에 불필요한 계정이 등록되어 있는 경우
EOF
BAR

cat $RESULT

FILE1=/etc/group
TMP2=/tmp/tmp1

cat $FILE1 | egrep -v '(^#|^$)' \
			| grep '^root' \
			| awk -F: '{print $4}' > $TMP2

cat << EOF >> $TMP1
========================================================================
다음 내용은 root 그룹에 속한 사용자 중 root 사용자를 제외한 사용자들입니다.
고객과 상의 후 삭제 및 변경 또는 유지를 결정하십시오.
========================================================================
EOF

for i in `cat $TMP2 | sed 's/,/ /g'`
do
	case $i in
		root) : ;;
		*)  echo "[WARN] $i : root 그룹에 속해야만 하는지 점검해야 합니다." >> $TMP1 
			;;
	esac
done

cat $TMP1
echo
