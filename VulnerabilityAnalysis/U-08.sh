#!/bin/bash

. function.sh

TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE "[U-08] /etc/shadow 파일 소유자 및 권한 설정"
cat << EOF >> $RESULT
[양호]:  /etc/shadow 파일의 소유자가 root이고, 권한이 400 이하인 경우
[취약]:  /etc/shadow 파일의 소유자가 root가 아니거나, 권한이 400 이하가 아닌 경우
EOF
BAR

FILENAME=/etc/shadow
OWNER=$(ls -l $FILENAME | awk {'print $3'})
PERM=$(ls -l $FILENAME | awk {'print $1'})

if [ $OWNER = "root" ] ; then
	OK $FILENAME 파일의 소유자가 root입니다.
else
	WARN $FILENAME 파일의 소유자가 root가 아닙니다.
fi

if [ $PERM = "----------" ] || [ $PERM = "r---------" ] ; then
	OK $FILENAME 파일의 권한이 400이하 입니다.
else
	WARN $FILENAME 파일의 권한이 400이하가 아닙니다.
fi

cat $RESULT
