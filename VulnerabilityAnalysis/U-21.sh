#!/bin/bash

. function.sh

TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE "[U-20] r 계열 서비스 비활성화"
cat << EOF >> $RESULT
[양호]:  불필요한 r 계열 서비스가 비활성화 되어 있는 경우
[취약]:  불필요한 r 계열 서비스가 활성화 되어 있는 경우
EOF
BAR

SERVICE1=$(systemctl is-active rlogin.socket)
SERVICE2=$(systemctl is-active rexec.socket)
SERVICE3=$(systemctl is-active rsh.socket)

if [ $SERVICE1 = "active" ] ; then
	WARN rlogin 서비스가 활성화 되어있습니다.
else
	OK rlogin 서비스가 활성화되어있지 않습니다.
fi

if [ $SERVICE2 = "active" ] ; then
	WARN rexec 서비스가 활성화 되어있습니다.
else
	OK rexec 서비스가 활성화되어있지 않습니다.
fi

if [ $SERVICE3 = "active" ] ; then
	WARN rsh 서비스가 활성화 되어있습니다.
else
	OK rsh 서비스가 활성화되어있지 않습니다.
fi

cat $RESULT
