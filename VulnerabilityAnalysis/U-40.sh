#!/bin/bash

. function.sh

TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE "[U-40] 웹서비스 파일 업로드 및 다운로드 제한"
cat << EOF >> $RESULT
[양호]: 파일 업로드 및 다운로드를 제한한 경우
[취약]: 파일 업로드 및 다운로드를 제한하지 않은 경우
EOF
BAR

SERVICE=$(systemctl is-active httpd.service)

if [ $SERVICE = "active" ] ; then
	INFO Apache 서비스가 활성화 되어있습니다.
	cat /etc/httpd/conf/httpd.conf | grep "LimitRequestBody" > $TMP1
	if [ -s $TMP1 ] ; then
		INFO 파일 사이즈 용량 제한 옵션이 설정되어 있습니다.
		INFO 업로드 및 다운로드 파일이 5M를 넘지 않도록 설정 권고함.
	else
		WARN 파일 사이즈 용량 제한 옵션이 설정되어 있지 않습니다.
	fi
else
	OK Apache 서비스가 비활성화 되어있습니다.
fi

cat $RESULT

