#!/bin/bash

. function.sh
TMP1=`SCRIPTNAME`.log
> $TMP1

BAR
CODE [U-47] 패스워드 최대 사용기간 설정
cat << EOF >> $RESULT
[양호]: 패스워드 최대 사용기간이 90일(12주) 이하로 설정되어 있는 경우
[취약]: 패스워드 최대 사용기간이 90일(12주) 이하로 설정되어 있지 않는 경우
EOF
BAR

LOGINDEFSFILE=/etc/login.defs
SEARCHVALUE=PASS_MAX_DAYS
NUM=$(SearchValue VALUE $LOGINDEFSFILE $SEARCHVALUE)
if [ $NUM -le 90 ] ; then
	OK "패스워드 최대 사용기간이 90일(12주) 이하로 설정되어 있습니다."
else
	WARN "패스워드 최대 사용기간이 90일(12주) 이하로 설정되어 있지 않습니다."
fi

cat $RESULT
echo
